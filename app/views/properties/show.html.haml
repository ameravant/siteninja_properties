- content_for :meta_title do
  == #{@property.formatted_address} Property Listing

- if params[:print] == "true"
  = render :partial => "print"
- else
  - content_for :head do
    :javascript
      jQuery(function() { 
      // setup ul.tabs to work as tabs for each div directly under div.panes 
      jQuery("ul.tabs").tabs("div.panes > div.panel"); 
      });
  - content_for :side_column do
    = link_to("Print", "javascript:void(0)", :onclick => "window.open ('#{property_path(@property)}?print=true','printproperty','menubar=0,width=700,height=500');", :class => "print")
    = clear
  = render :partial => "shared/embed_slideshow"
  #primary-info{:class => (@property.sold? ? "property-sold" : "property-available")}
    %address
      %span#main-address= @property.address + ", "
      == #{@property.city}, #{@property.state} #{@property.zip}
    #property-price
      #price
        - if @property.sold?
          %span.sold Sold
          %span.strikethrough= number_to_currency(@property.reduced_price)
        - else
          - if @property.reduced_price != @property.asking_price
            %span.price= number_to_currency(@property.reduced_price)
            %span.strikethrough= number_to_currency(@property.asking_price)
          - else
            %span.price= number_to_currency(@property.asking_price)
        =display_status(@property)
    - unless @property.beds_count.blank? and @property.baths_count.blank?
      #property-size
        = pluralize(@property.beds_count, "Bed")
        |
        = pluralize(@property.baths_count, "Bath")
  %ul.tabs
    %li= link_to("Description", "#Description")
    - if !@property.directions.blank?
      %li= link_to("Directions", "#Directions")
    - if !@property.showing_instructions.blank?
      %li= link_to("Showing Instructions", "#ShowingInstructions")
    - unless @property.person.profile.blank?
      - if @property.person.properties.size > 1
        %li= link_to("Listings", "#OwnerListings")
  = clear
  .screen
    .panes
      .panel
        = @property.body.blank? ? simple_format(@property.description) : @property.body
      - unless @property.directions.blank?
        .panel
          = simple_format(@property.directions)
      - unless @property.showing_instructions.blank?
        .panel
          = simple_format(@property.showing_instructions)
      - unless @property.person.profile.blank?
        - if @property.person.properties.size > 1
          .panel
            -for status in ["Active", "Pending", "Sold"]
              - unless eval("@#{status.downcase}_properties").empty?
                - unless @property.person.properties.send("pending").by_price.any? and @property.person.properties.send("sold").by_price.any?
                  %h2= status
                =render :partial => "properties/property_list", :locals => {:region => @region, :properties => @property.person.properties.send(status.downcase.to_sym).by_price}

  - address = "#{@property.address.strip}, #{@property.city}, #{@property.state}"
  - content_for :head do
    = render :partial => "google_maps_includes"
  - content_for :side_column do
  
    - unless @property.person.profile.blank?
      #contact-info
        %div
          = image_tag(@property.person.avatar.url(:profile_thumb), :alt => "Profile photo for %s" % @property.person.name, :class => "profile-image") if @property.person.avatar_file_name
          - if @property.person.profile
            .small Presented By
            #owner-name= link_to(@property.person.name, @property.person.profile)
            #contact-info-detail
              = simple_format(@property.person.profile.short_description)
              - if @property.person.profile.show_dre_license
                ==DRE License: #{@property.person.dre_license}
                %br
              - if @property.person.profile.show_phone
                = @property.person.phone
                %br
              - if @property.person.profile.show_email
                %br
                = link_to("Email", "mailto:#{@property.person.email}")
              - if @property.person.profile.show_web_address
                %br
                = link_to("Visit Website", @property.person.web_address)
          = clear
    .clear
    #map-outer{:class => "side-column-section"}
      #google_map
      %div= link_to "View larger map", "http://maps.google.com?q=#{u address}"
    
  .print-panes
    .print-panel
      %h2 Description
      = @property.body.blank? ? simple_format(@property.description) : @property.body
    - unless @property.directions.blank?
      .print-panel
        %h2 Directions
        = simple_format(@property.directions)
    - unless @property.showing_instructions.blank?
      .print-panel
        %h2 Showing Instructions
        = simple_format(@property.showing_instructions)
    = clear
  = clear
.clear
  - content_for :head do
    = stylesheet_link_tag "/plugin_assets/siteninja_properties/stylesheets/property_styles.css"
    %link{:href => "/plugin_assets/siteninja_properties/stylesheets/property_print_styles.css", :media => "print", :rel => "stylesheet", :type => "text/css"}
